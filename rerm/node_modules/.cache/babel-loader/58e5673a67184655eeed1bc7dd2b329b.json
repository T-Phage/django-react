{"ast":null,"code":"import _defineProperty from\"/home/sammy/projects/jwtenv/howprofile/rerm/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/home/sammy/projects/jwtenv/howprofile/rerm/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"/home/sammy/projects/jwtenv/howprofile/rerm/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/sammy/projects/jwtenv/howprofile/rerm/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/home/sammy/projects/jwtenv/howprofile/rerm/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/home/sammy/projects/jwtenv/howprofile/rerm/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/sammy/projects/jwtenv/howprofile/rerm/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import{BrowserRouter as Router,Switch,Route,Link}from\"react-router-dom\";import Modal from'./components/Modal';import Profile from'./components/Profile';// import './index.css'\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Mainapp=/*#__PURE__*/function(_React$Component){_inherits(Mainapp,_React$Component);var _super=_createSuper(Mainapp);function Mainapp(props){var _this;_classCallCheck(this,Mainapp);_this=_super.call(this,props);_this.showModal=function(){_this.setState(_objectSpread(_objectSpread({},_this.state.show),{},{show:true}));};_this.hideModal=function(){_this.setState(_objectSpread(_objectSpread({},_this.state.show),{},{show:false}));};_this.state={show:false,currentuser:[],longindetails:{username:\"\",password:\"\"}};_this.getCurentUser=_this.getCurentUser.bind(_assertThisInitialized(_this));_this.handleChange=_this.handleChange.bind(_assertThisInitialized(_this));_this.handleSubmit=_this.handleSubmit.bind(_assertThisInitialized(_this));_this.refreshToken=_this.refreshToken.bind(_assertThisInitialized(_this));_this.after5minutes=_this.after5minutes.bind(_assertThisInitialized(_this));// this.handlesignout = this.handlesignout.bind(this)\nreturn _this;}_createClass(Mainapp,[{key:\"componentDidMount\",value:function componentDidMount(){this.getCurentUser();}},{key:\"after5minutes\",value:function after5minutes(){setInterval(function(){console.log('after');},5000);}},{key:\"refreshToken\",value:function refreshToken(){var _this2=this;fetch('http://127.0.0.1:8000/token/refresh/',{method:'POST',mode:'cors',cache:'no-cache',credentials:'omit',headers:{// 'Content-Type' : 'application/x-www-form-urlencoded'\n'Content-Type':'application/json','accept':'application/json'// 'Authorization': 'JWT ' + localStorage.getItem('access_token')             \n},body:JSON.stringify({'refresh':localStorage.getItem('refresh_token')})}).then(function(response){return response.json();}).then(function(data){console.log('Data :',data);if(data.access){localStorage.setItem('access_token',data.access);localStorage.setItem('refresh_token',data.refresh);_this2.showSuccess();_this2.getCurentUser();}else if(data.detail){// 'No active account found with the given credentials'\n// console.log('not valid')\nlocalStorage.setItem('access_token','');localStorage.setItem('refresh_token','');_this2.showModal();}}).catch(function(error){// console.log(error)\n});}},{key:\"getCurentUser\",value:function getCurentUser(){var _this3=this;fetch('http://127.0.0.1:8000/active/user/',{method:'GET',mode:'cors',cache:'no-cache',credentials:'omit',headers:{// 'Content-Type' : 'application/x-www-form-urlencoded'\n'Content-Type':'application/json','accept':'application/json','Authorization':'JWT '+localStorage.getItem('access_token')}// body: JSON.stringify(this.state)\n}).then(function(response){return response.json();}).then(function(data){// console.log('Data :', data)\nif(data.code===\"token_not_valid\"){// this.showModal()\n_this3.refreshToken();}else{console.log('gfhk');_this3.setState({currentuser:data});// this.state.currentuser.append(data)\nconsole.log(\"user :\",_this3.state.currentuser);}}).catch(function(error){// console.log(error)\n});}},{key:\"handleChange\",value:function handleChange(event){this.setState({longindetails:_objectSpread(_objectSpread({},this.state.longindetails),{},_defineProperty({},event.target.name,event.target.value))});console.log(this.state.longindetails);}},{key:\"handleSubmit\",value:function handleSubmit(event){var _this4=this;// alert('A username and password was submitted: ' + this.state.username + \" \" + this.state.password);\nevent.preventDefault();fetch('http://127.0.0.1:8000/token/obtain/',{method:'POST',mode:'cors',cache:'no-cache',credentials:'omit',headers:{// 'Content-Type' : 'application/x-www-form-urlencoded'\n'Content-Type':'application/json','accept':'application/json'},body:JSON.stringify(this.state.longindetails)}).then(function(response){return response.json();}).then(function(data){console.log('Data :',data);if(data.access){localStorage.setItem('access_token',data.access);localStorage.setItem('refresh_token',data.refresh);_this4.hideModal();_this4.getCurentUser();window.location.reload();}else if(data.detail){// 'No active account found with the given credentials'\n// console.log('not valid')\nlocalStorage.setItem('access_token','');localStorage.setItem('refresh_token','');_this4.showModal();}}).catch(function(error){console.log(error);});}},{key:\"handlesignout\",value:function handlesignout(){// e.preventDefault()\nfetch('http://127.0.0.1:8000/user/logout/',{method:'POST',mode:'cors',cache:'no-cache',credentials:'omit',headers:{// 'Content-Type' : 'application/x-www-form-urlencoded'\n'Content-Type':'application/json','accept':'application/json','Authorization':'JWT '+localStorage.getItem('access_token')},body:JSON.stringify({'refresh':localStorage.getItem('refresh_token')})}).then(function(response){return response.json();}).then(function(data){console.log('Data :',data);localStorage.setItem('access_token','');localStorage.setItem('refresh_token','');});}},{key:\"render\",value:function render(){return/*#__PURE__*/_jsxs(Router,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"App\",children:/*#__PURE__*/_jsx(\"nav\",{className:\"navbar navbar-expand-lg navbar-light fixed-top\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(Link,{className:\"navbar-brand\",to:\"/sign-in\",children:\"positronX.io\"}),/*#__PURE__*/_jsx(\"div\",{className:\"collapse navbar-collapse\",id:\"navbarTogglerDemo02\",children:/*#__PURE__*/_jsxs(\"ul\",{className:\"navbar-nav ml-auto\",children:[/*#__PURE__*/_jsx(\"li\",{className:\"nav-item\"}),/*#__PURE__*/_jsx(\"li\",{className:\"nav-item\"})]})})]})})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(Modal,{show:this.state.show,handleClose:this.hideModal,children:[\"Session closed\",/*#__PURE__*/_jsxs(\"form\",{onSubmit:this.handleSubmit,children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Sign In\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Username\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"username\",value:this.state.longindetails.username,onChange:this.handleChange,className:\"form-control\",placeholder:\"Enter username\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Password\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",name:\"password\",value:this.state.longindetails.password,onChange:this.handleChange,className:\"form-control\",placeholder:\"Enter password\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",children:/*#__PURE__*/_jsx(\"div\",{className:\"custom-control custom-checkbox\",children:/*#__PURE__*/_jsx(\"br\",{})})}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary btn-block\",children:\"Submit\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"forgot-password text-right\",children:[\"Forgot \",/*#__PURE__*/_jsx(\"a\",{href:\"#\",children:\"password?\"})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"create-account text-right\",children:[\"Click to \",/*#__PURE__*/_jsx(Link,{to:\"/sign-up\",children:\"Create an Account\"})]})]}),/*#__PURE__*/_jsx(\"br\",{})]}),/*#__PURE__*/_jsx(\"div\",{className:\"auth-wrapper\",children:/*#__PURE__*/_jsx(\"div\",{className:\"auth-inner\",children:/*#__PURE__*/_jsxs(Switch,{children:[/*#__PURE__*/_jsx(Route,{exact:true,path:\"/dash\",component:Profile}),/*#__PURE__*/_jsx(Route,{path:\"/profile\",component:Profile})]})})})]})]});}}]);return Mainapp;}(React.Component);export{Mainapp as default};","map":{"version":3,"sources":["/home/sammy/projects/jwtenv/howprofile/rerm/src/Mainapp.js"],"names":["React","BrowserRouter","Router","Switch","Route","Link","Modal","Profile","Mainapp","props","showModal","setState","state","show","hideModal","currentuser","longindetails","username","password","getCurentUser","bind","handleChange","handleSubmit","refreshToken","after5minutes","setInterval","console","log","fetch","method","mode","cache","credentials","headers","body","JSON","stringify","localStorage","getItem","then","response","json","data","access","setItem","refresh","showSuccess","detail","catch","error","code","event","target","name","value","preventDefault","window","location","reload","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { BrowserRouter as Router, Switch, Route, Link } from \"react-router-dom\";\nimport Modal from './components/Modal';\nimport Profile from './components/Profile';\n// import './index.css'\n\nexport default class Mainapp extends React.Component {\n    constructor(props){\n        super(props);\n        this.state = {\n            show:false,\n            currentuser: [],\n            longindetails: {username: \"\", password: \"\"},\n        }\n\n        this.getCurentUser = this.getCurentUser.bind(this)\n        this.handleChange = this.handleChange.bind(this)\n        this.handleSubmit = this.handleSubmit.bind(this)\n        this.refreshToken = this.refreshToken.bind(this)\n        this.after5minutes = this.after5minutes.bind(this)\n        // this.handlesignout = this.handlesignout.bind(this)\n    }\n\n    componentDidMount() {\n        this.getCurentUser()\n    }\n\n    showModal = () => {\n        this.setState({\n            ...this.state.show,\n            show: true\n        })\n    }\n\n    hideModal = () => {\n        this.setState({\n            ...this.state.show,\n            show: false\n        })\n    }\n\n    after5minutes(){\n        setInterval( function(){console.log('after')},5000)\n    }\n\n    refreshToken(){\n        fetch('http://127.0.0.1:8000/token/refresh/',{ \n            method : 'POST',\n            mode : 'cors',\n            cache : 'no-cache',\n            credentials : 'omit',\n            headers: {\n                // 'Content-Type' : 'application/x-www-form-urlencoded'\n                'Content-Type': 'application/json',\n                'accept': 'application/json',  \n                // 'Authorization': 'JWT ' + localStorage.getItem('access_token')             \n            }, \n            body: JSON.stringify({'refresh': localStorage.getItem('refresh_token')})\n        })\n        .then(response => response.json())\n        .then(data => {\n            console.log('Data :', data)\n            \n            if (data.access){\n                localStorage.setItem('access_token', data.access)\n                localStorage.setItem('refresh_token', data.refresh)\n                this.showSuccess()\n                this.getCurentUser()\n            }\n            else if(data.detail){\n                // 'No active account found with the given credentials'\n                // console.log('not valid')\n                localStorage.setItem('access_token', '')\n                localStorage.setItem('refresh_token', '')\n                this.showModal()\n            } \n        })\n        .catch((error) => {\n            // console.log(error)\n        })\n    }\n\n    getCurentUser(){\n        fetch('http://127.0.0.1:8000/active/user/',{ \n            method : 'GET',\n            mode : 'cors',\n            cache : 'no-cache',\n            credentials : 'omit',\n            headers: {\n                // 'Content-Type' : 'application/x-www-form-urlencoded'\n                'Content-Type': 'application/json',\n                'accept': 'application/json',  \n                'Authorization': 'JWT ' + localStorage.getItem('access_token')             \n            }, \n            // body: JSON.stringify(this.state)\n        })\n        .then(response => response.json())\n        .then(data => {\n            // console.log('Data :', data)\n            if(data.code === \"token_not_valid\"){\n                // this.showModal()\n                    this.refreshToken()\n            }   else {\n                console.log('gfhk')\n                this.setState({\n                    currentuser:data\n                });\n                // this.state.currentuser.append(data)\n                console.log(\"user :\",this.state.currentuser)\n            }\n        })\n        .catch((error) => {\n            // console.log(error)\n        })\n    }\n\n    handleChange(event) {\n        this.setState({\n            longindetails:{\n                ...this.state.longindetails,\n                [event.target.name]: event.target.value}\n        });\n        console.log(this.state.longindetails)\n    }\n\n    handleSubmit(event) {\n        // alert('A username and password was submitted: ' + this.state.username + \" \" + this.state.password);\n        event.preventDefault();\n        fetch('http://127.0.0.1:8000/token/obtain/', {\n            method : 'POST',\n            mode : 'cors',\n            cache : 'no-cache',\n            credentials : 'omit',\n            headers: {\n                // 'Content-Type' : 'application/x-www-form-urlencoded'\n                'Content-Type': 'application/json',\n                'accept': 'application/json',           \n            }, \n            body: JSON.stringify(this.state.longindetails)\n        })\n        .then(response => response.json())\n        .then(data => {\n            console.log('Data :', data)\n            \n            if (data.access){\n                localStorage.setItem('access_token', data.access)\n                localStorage.setItem('refresh_token', data.refresh)\n                this.hideModal()\n                this.getCurentUser()\n                window.location.reload()\n            }\n            else if(data.detail){\n                // 'No active account found with the given credentials'\n                // console.log('not valid')\n                localStorage.setItem('access_token', '')\n                localStorage.setItem('refresh_token', '')\n                this.showModal()\n            } \n        })\n        .catch((error) => {\n            console.log(error)\n        })\n    }\n\n    handlesignout(){\n        // e.preventDefault()\n        fetch('http://127.0.0.1:8000/user/logout/', {\n            method : 'POST',\n            mode : 'cors',\n            cache : 'no-cache',\n            credentials : 'omit',\n            headers: {\n                // 'Content-Type' : 'application/x-www-form-urlencoded'\n                'Content-Type': 'application/json',\n                'accept': 'application/json',\n                'Authorization': 'JWT ' + localStorage.getItem('access_token'),       \n            }, \n            body: JSON.stringify({'refresh':localStorage.getItem('refresh_token')})\n        })\n        .then(response => response.json())\n        .then(data => {\n            console.log('Data :', data) \n            localStorage.setItem('access_token', '')\n            localStorage.setItem('refresh_token', '')\n        })\n        \n\n    }\n\n    render() {\n    return (<Router>\n      <div className=\"App\">\n        <nav className=\"navbar navbar-expand-lg navbar-light fixed-top\">\n          <div className=\"container\">\n            <Link className=\"navbar-brand\" to={\"/sign-in\"}>positronX.io</Link>\n            <div className=\"collapse navbar-collapse\" id=\"navbarTogglerDemo02\">\n              <ul className=\"navbar-nav ml-auto\">\n                <li className=\"nav-item\">\n                  {/* <Link className=\"nav-link\" to={} onClick={this.hahandlesignout}>Logout</Link> */}\n                </li>\n                <li className=\"nav-item\">\n                  {/* <Link className=\"nav-link\" to={\"/sign-up\"}>Sign up</Link> */}\n                </li>\n              </ul>\n            </div>\n          </div>\n        </nav>\n      </div>\n        <div>\n            <Modal show={this.state.show} handleClose={this.hideModal}>\n                   \n                Session closed\n\n                <form onSubmit={this.handleSubmit}>\n                    <h3>Sign In</h3>\n\n                    <div className=\"form-group\">\n                        <label>Username</label>\n                        <input type=\"text\" name=\"username\" value={this.state.longindetails.username} onChange={this.handleChange} className=\"form-control\" placeholder=\"Enter username\" />\n                    </div>\n\n                    <div className=\"form-group\">\n                        <label>Password</label>\n                        <input type=\"password\" name=\"password\" value={this.state.longindetails.password} onChange={this.handleChange} className=\"form-control\" placeholder=\"Enter password\" />\n                    </div>\n\n                    <div className=\"form-group\">\n                        <div className=\"custom-control custom-checkbox\">\n                            {/* <input type=\"checkbox\" className=\"custom-control-input\" id=\"customCheck1\" /> */}\n                            {/* <label className=\"custom-control-label\" htmlFor=\"customCheck1\">Remember me</label> */}\n                            <br />\n                        </div>\n                    </div>\n\n                    <button type=\"submit\" className=\"btn btn-primary btn-block\">Submit</button>\n                    <p className=\"forgot-password text-right\">\n                        Forgot <a href=\"#\">password?</a>\n                    </p>\n                    <p className=\"create-account text-right\">\n                        Click to <Link to={\"/sign-up\"}>Create an Account</Link>\n                    </p>\n                </form>\n                    <br />\n                    {/* <Link to={\"/sign-in\"}>Login</Link> */}\n            </Modal>\n            <div className=\"auth-wrapper\">\n                <div className=\"auth-inner\"> \n                    \n                <Switch>\n                    <Route exact path='/dash' component={Profile} />\n                    <Route path=\"/profile\" component={Profile} />\n                </Switch>\n                </div>\n            </div>\n        </div>\n      </Router>\n    );\n  }\n}"]},"metadata":{},"sourceType":"module"}