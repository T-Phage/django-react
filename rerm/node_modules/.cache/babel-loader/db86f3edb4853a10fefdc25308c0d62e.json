{"ast":null,"code":"import _defineProperty from\"/home/sammy/projects/jwtenv/howprofile/rerm/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/home/sammy/projects/jwtenv/howprofile/rerm/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"/home/sammy/projects/jwtenv/howprofile/rerm/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/sammy/projects/jwtenv/howprofile/rerm/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/home/sammy/projects/jwtenv/howprofile/rerm/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/home/sammy/projects/jwtenv/howprofile/rerm/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/sammy/projects/jwtenv/howprofile/rerm/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import{Link}from'react-router-dom';import Modal from'./Modal';import Success from'./SuccessModal';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Login=/*#__PURE__*/function(_React$Component){_inherits(Login,_React$Component);var _super=_createSuper(Login);function Login(props){var _this;_classCallCheck(this,Login);_this=_super.call(this,props);_this.showSuccess=function(){_this.setState(_objectSpread(_objectSpread({},_this.state.success),{},{success:true}));};_this.showModal=function(){_this.setState(_objectSpread(_objectSpread({},_this.state.show),{},{show:true}));};_this.hideModal=function(){_this.setState(_objectSpread(_objectSpread({},_this.state.show),{},{show:false}));};_this.state={longindetails:{username:\"\",password:\"\"},show:false,success:false};_this.handleChange=_this.handleChange.bind(_assertThisInitialized(_this));_this.handleSubmit=_this.handleSubmit.bind(_assertThisInitialized(_this));_this.handlesignout=_this.handlesignout.bind(_assertThisInitialized(_this));return _this;}_createClass(Login,[{key:\"componentDidMount\",value:function componentDidMount(){this.handlesignout();}},{key:\"handleChange\",value:function handleChange(event){this.setState({longindetails:_objectSpread(_objectSpread({},this.state.longindetails),{},_defineProperty({},event.target.name,event.target.value))});// console.log(this.state.longindetails)\n}},{key:\"handleSubmit\",value:function handleSubmit(event){var _this2=this;// alert('A username and password was submitted: ' + this.state.username + \" \" + this.state.password);\nevent.preventDefault();fetch('https://testingmyapis.herokuapp.com/api/token/obtain/',{method:'POST',mode:'cors',cache:'no-cache',credentials:'omit',headers:{// 'Content-Type' : 'application/x-www-form-urlencoded'\n'Content-Type':'application/json','accept':'application/json'},body:JSON.stringify(this.state.longindetails)}).then(function(response){return response.json();}).then(function(data){// console.log('Data :', data)\nif(data.access){localStorage.setItem('access_token',data.access);localStorage.setItem('refresh_token',data.refresh);_this2.showSuccess();}else if(data.detail){// 'No active account found with the given credentials'\n// console.log('not valid')\nlocalStorage.setItem('access_token','');localStorage.setItem('refresh_token','');_this2.showModal();}}).catch(function(error){// console.log(error)\n});}},{key:\"handlesignout\",value:function handlesignout(){// e.preventDefault()\nfetch('https://testingmyapis.herokuapp.com/api/user/logout/',{method:'POST',mode:'cors',cache:'no-cache',credentials:'omit',headers:{// 'Content-Type' : 'application/x-www-form-urlencoded'\n'Content-Type':'application/json','accept':'application/json','Authorization':'JWT '+localStorage.getItem('access_token')},body:JSON.stringify({'refresh':localStorage.getItem('refresh_token')})}).then(function(response){return response.json();}).then(function(data){// console.log('Data :', data) \nlocalStorage.setItem('access_token','');localStorage.setItem('refresh_token','');});}},{key:\"render\",value:function render(){return/*#__PURE__*/_jsxs(\"form\",{onSubmit:this.handleSubmit,children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Sign In\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Username\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"username\",value:this.state.longindetails.username,onChange:this.handleChange,className:\"form-control\",placeholder:\"Enter username\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Password\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",name:\"password\",value:this.state.longindetails.password,onChange:this.handleChange,className:\"form-control\",placeholder:\"Enter password\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"custom-control custom-checkbox\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",className:\"custom-control-input\",id:\"customCheck1\"}),/*#__PURE__*/_jsx(\"label\",{className:\"custom-control-label\",htmlFor:\"customCheck1\",children:\"Remember me\"})]})}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary btn-block\",children:\"Submit\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"forgot-password text-right\",children:[\"Forgot \",/*#__PURE__*/_jsx(\"a\",{href:\"#\",children:\"password?\"})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"create-account text-right\",children:[\"Click to \",/*#__PURE__*/_jsx(Link,{to:\"/sign-up\",children:\"Create an Account\"})]}),/*#__PURE__*/_jsxs(Modal,{show:this.state.show,handleClose:this.hideModal,children:[/*#__PURE__*/_jsx(\"p\",{children:\"Modal\"}),\"No active account found with the given credentials\",/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-danger btn-block\",onClick:this.hideModal,children:\"Retry\"})]}),/*#__PURE__*/_jsxs(Success,{show:this.state.success,children:[\"Successfully logged in\",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"a\",{href:\"/dash\",children:\"Ok\"})]})]});}}]);return Login;}(React.Component);export{Login as default};","map":{"version":3,"sources":["/home/sammy/projects/jwtenv/howprofile/rerm/src/components/Login.js"],"names":["React","Link","Modal","Success","Login","props","showSuccess","setState","state","success","showModal","show","hideModal","longindetails","username","password","handleChange","bind","handleSubmit","handlesignout","event","target","name","value","preventDefault","fetch","method","mode","cache","credentials","headers","body","JSON","stringify","then","response","json","data","access","localStorage","setItem","refresh","detail","catch","error","getItem","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { Link } from 'react-router-dom';\nimport Modal from './Modal';\nimport Success from './SuccessModal'\n\nexport default class Login extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            longindetails: {username: \"\", password: \"\"},\n            show:false,\n            success:false\n        };\n        \n        this.handleChange = this.handleChange.bind(this);\n        this.handleSubmit = this.handleSubmit.bind(this);\n        this.handlesignout = this.handlesignout.bind(this);\n    }\n\n    componentDidMount(){\n        this.handlesignout()\n    }\n\n    showSuccess = () => {\n        this.setState({\n            ...this.state.success,\n            success: true\n        })\n    }\n\n    showModal = () => {\n        this.setState({\n            ...this.state.show,\n            show: true\n        })\n    }\n\n    hideModal = () => {\n        this.setState({\n            ...this.state.show,\n            show: false\n        })\n    }\n\n    handleChange(event) {\n        this.setState({\n            longindetails:{\n                ...this.state.longindetails,\n                [event.target.name]: event.target.value}\n        });\n        // console.log(this.state.longindetails)\n    }\n\n    handleSubmit(event) {\n        // alert('A username and password was submitted: ' + this.state.username + \" \" + this.state.password);\n        event.preventDefault();\n        fetch('https://testingmyapis.herokuapp.com/api/token/obtain/', {\n            method : 'POST',\n            mode : 'cors',\n            cache : 'no-cache',\n            credentials : 'omit',\n            headers: {\n                // 'Content-Type' : 'application/x-www-form-urlencoded'\n                'Content-Type': 'application/json',\n                'accept': 'application/json',               \n            }, \n            body: JSON.stringify(this.state.longindetails)\n        })\n        .then(response => response.json())\n        .then(data => {\n            // console.log('Data :', data)\n            \n            if (data.access){\n                localStorage.setItem('access_token', data.access)\n                localStorage.setItem('refresh_token', data.refresh)\n                this.showSuccess()\n                \n            }\n            else if(data.detail){\n                // 'No active account found with the given credentials'\n                // console.log('not valid')\n                localStorage.setItem('access_token', '')\n                localStorage.setItem('refresh_token', '')\n                this.showModal()\n            } \n        })\n        .catch((error) => {\n            // console.log(error)\n        })\n    }\n\n    handlesignout(){\n        // e.preventDefault()\n        fetch('https://testingmyapis.herokuapp.com/api/user/logout/', {\n            method : 'POST',\n            mode : 'cors',\n            cache : 'no-cache',\n            credentials : 'omit',\n            headers: {\n                // 'Content-Type' : 'application/x-www-form-urlencoded'\n                'Content-Type': 'application/json',\n                'accept': 'application/json',\n                'Authorization': 'JWT ' + localStorage.getItem('access_token'),       \n            }, \n            body: JSON.stringify({'refresh':localStorage.getItem('refresh_token')})\n        })\n        .then(response => response.json())\n        .then(data => {\n            // console.log('Data :', data) \n            localStorage.setItem('access_token', '')\n            localStorage.setItem('refresh_token', '')\n        })\n    }\n\n    render() {\n        return(\n            <form onSubmit={this.handleSubmit}>\n                <h3>Sign In</h3>\n\n                <div className=\"form-group\">\n                    <label>Username</label>\n                    <input type=\"text\" name=\"username\" value={this.state.longindetails.username} onChange={this.handleChange} className=\"form-control\" placeholder=\"Enter username\" />\n                </div>\n\n                <div className=\"form-group\">\n                    <label>Password</label>\n                    <input type=\"password\" name=\"password\" value={this.state.longindetails.password} onChange={this.handleChange} className=\"form-control\" placeholder=\"Enter password\" />\n                </div>\n\n                <div className=\"form-group\">\n                    <div className=\"custom-control custom-checkbox\">\n                        <input type=\"checkbox\" className=\"custom-control-input\" id=\"customCheck1\" />\n                        <label className=\"custom-control-label\" htmlFor=\"customCheck1\">Remember me</label>\n                    </div>\n                </div>\n\n                <button type=\"submit\" className=\"btn btn-primary btn-block\">Submit</button>\n                <p className=\"forgot-password text-right\">\n                    Forgot <a href=\"#\">password?</a>\n                </p>\n                <p className=\"create-account text-right\">\n                    Click to <Link to={\"/sign-up\"}>Create an Account</Link>\n                </p>\n                 <Modal show={this.state.show} handleClose={this.hideModal}>\n                    <p>Modal</p>\n                    No active account found with the given credentials\n\n                    <button type=\"button\" className=\"btn btn-danger btn-block\" onClick={this.hideModal}>\n                    Retry\n                    </button>\n                    {/* <Link to={\"/sign-in\"}>Retry</Link> */}\n                </Modal>\n                <Success show={this.state.success} >\n                    Successfully logged in\n                    <br />\n                    <a href=\"/dash\">Ok</a>\n                </Success>\n            </form>\n        )\n    }\n}\n"]},"metadata":{},"sourceType":"module"}